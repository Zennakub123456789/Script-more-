local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local petsServiceRemote = ReplicatedStorage:WaitForChild("GameEvents"):WaitForChild("PetsService")
local localPlayer = game:GetService("Players").LocalPlayer
local petsFolder = workspace:WaitForChild("PetsPhysical")

local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

WindUI:SetNotificationLower(true)

local Window = WindUI:CreateWindow({
    Title = "Tad Hub | Grow a Graden | 0.0.1",
    Icon = "door-open",
    Author = "By Tad Hub",
    Folder = "TadHub",
    Size = UDim2.fromOffset(550, 350),
    Transparent = true,
    Theme = "Dark",
    Resizable = true,
    SideBarWidth = 200,
    Background = "", -- rbxassetid only
    BackgroundImageTransparency = 0.42,
    HideSearchBar = true,
    ScrollBarEnabled = false,
    User = {
        Enabled = true,
        Anonymous = true,
        Callback = function()
            print("clicked")
        end,
    },
})

Window:EditOpenButton({
    Title = "Open Example UI",
    Icon = "monitor",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 2,
    Color = ColorSequence.new( -- gradient
        Color3.fromHex("FF0F7B"), 
        Color3.fromHex("F89B29")
    ),
    OnlyMobile = false,
    Enabled = true,
    Draggable = true,
})

Window:IsResizable(true)

Window:SetToggleKey(Enum.KeyCode.H)

local Tab = Window:Tab({
    Title = "Main",
    Icon = "bird",
    Locked = false,
})
local Section = Tab:Section({ 
    Title = "Main",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})

-- üîÅ ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏´‡∏•‡∏±‡∏Å
local teamNames = {}
if isfolder("PetsTeam") then
    for _, file in ipairs(listfiles("PetsTeam")) do
        local name = file:match("PetsTeam/(.+)%.json")
        if name then
            table.insert(teamNames, name)
        end
    end
end

-- üîß ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ UI (‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô)
local LoadTeamDropdown
local DeleteDropdown

local teamName = ""
local selectedTeam = ""
local selectedDeleteTeam = ""

-- 1Ô∏è‚É£ ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°
PetnameInput = Tab:Input({
    Title = "üìù ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°",
    Callback = function(text)
        teamName = text
    end
})

-- 2Ô∏è‚É£ ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡∏°
local SaveTeamButton = Tab:Button({
    Title = "üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡∏°",
    Callback = function()
        if teamName == "" then
            return WindUI:Notify({
                Title = "‚ö†Ô∏è ‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏ß‡πà‡∏≤‡∏á",
                Content = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å",
                Icon = "alert",
                Duration = 3
            })
        end

        -- ‡πÄ‡∏Å‡πá‡∏ö UUID ‡∏à‡∏≤‡∏Å‡∏™‡∏ß‡∏ô
        local uuids = {}
        for _, petMover in ipairs(petsFolder:GetChildren()) do
            if petMover.Name == "PetMover" then
                local owner = petMover:GetAttribute("OWNER")
                local uuid = petMover:GetAttribute("UUID")
                if owner == localPlayer.Name and uuid then
                    table.insert(uuids, uuid)
                end
            end
        end

        if #uuids == 0 then
            return WindUI:Notify({
                Title = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á",
                Content = "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏±‡∏ï‡∏ß‡πå‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ô‡∏™‡∏ß‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ",
                Icon = "cat",
                Duration = 3
            })
        end

        -- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå
        local data = { uuids = uuids }
        local json = HttpService:JSONEncode(data)
        if not isfolder("PetsTeam") then
            makefolder("PetsTeam")
        end
        writefile("PetsTeam/" .. teamName .. ".json", json)

        -- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡πÉ‡∏ô Dropdown ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
        local found = false
        for _, name in ipairs(teamNames) do
            if name == teamName then
                found = true
                break
            end
        end

        if not found then
            table.insert(teamNames, teamName)
        end

        -- ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä Dropdown ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà
        if LoadTeamDropdown then
            LoadTeamDropdown:Refresh(teamNames)
        end
        if DeleteDropdown then
            DeleteDropdown:Refresh(teamNames)
        end

        WindUI:Notify({
            Title = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
            Content = "‡∏ó‡∏µ‡∏° '" .. teamName .. "' ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß",
            Icon = "save",
            Duration = 3
        })
    end
})

-- 3Ô∏è‚É£ Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°‡πÑ‡∏ß‡πâ‡πÇ‡∏´‡∏•‡∏î
LoadTeamDropdown = Tab:Dropdown({
    Title = "üìÇ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°",
    Values = teamNames,
    Callback = function(option)
        selectedTeam = option
        print("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°:", selectedTeam)
    end
})

-- 4Ô∏è‚É£ ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡∏° (Unequip ‡πÅ‡∏•‡πâ‡∏ß Equip)
LoadTeam = Tab:Button({
    Title = "üì• ‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡∏° (Unequip ‡∏Å‡πà‡∏≠‡∏ô)",
    Callback = function()
        if selectedTeam == "" then
            return WindUI:Notify({
                Title = "‚ö†Ô∏è ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°",
                Content = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î",
                Icon = "alert",
                Duration = 3
            })
        end

        -- Unequip
        for _, petMover in ipairs(petsFolder:GetChildren()) do
            if petMover.Name == "PetMover" then
                local owner = petMover:GetAttribute("OWNER")
                local uuid = petMover:GetAttribute("UUID")
                if owner == localPlayer.Name and uuid then
                    petsServiceRemote:FireServer("UnequipPet", uuid)
                    wait(0.1)
                end
            end
        end

        -- ‡πÇ‡∏´‡∏•‡∏î UUID ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå
        local success, result = pcall(function()
            return readfile("PetsTeam/" .. selectedTeam .. ".json")
        end)

        if not success then
            return WindUI:Notify({
                Title = "‚ùå ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                Content = "‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå: " .. selectedTeam,
                Icon = "folder-x",
                Duration = 3
            })
        end

        local data = HttpService:JSONDecode(result)
        for _, uuid in ipairs(data.uuids or {}) do
            petsServiceRemote:FireServer("EquipPet", uuid, CFrame.new(0, 0, 0))
            wait(0.1)
        end

        WindUI:Notify({
            Title = "‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
            Content = "‡∏ó‡∏µ‡∏° '" .. selectedTeam .. "' ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß",
            Icon = "download",
            Duration = 3
        })
    end
})

-- 5Ô∏è‚É£ Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö
DeleteDropdown = Tab:Dropdown({
    Title = "üóëÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö",
    Values = teamNames,
    Callback = function(selected)
        selectedDeleteTeam = selected
    end
})

DeleteButton = Tab:Button({
    Title = "‚ùå ‡∏•‡∏ö‡∏ó‡∏µ‡∏°",
    Callback = function()
        if selectedDeleteTeam == "" then
            return WindUI:Notify({
                Title = "‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°",
                Content = "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∂‡∏á‡∏à‡∏∞‡∏•‡∏ö‡πÑ‡∏î‡πâ",
                Icon = "alert",
                Duration = 3
            })
        end

        local filePath = "PetsTeam/" .. selectedDeleteTeam .. ".json"
        if isfile(filePath) then
            delfile(filePath)

            for i, name in ipairs(teamNames) do
                if name == selectedDeleteTeam then
                    table.remove(teamNames, i)
                    break
                end
            end

            if LoadTeamDropdown then LoadTeamDropdown:Refresh(teamNames) end
            if DeleteDropdown then DeleteDropdown:Refresh(teamNames) end

            selectedDeleteTeam = ""

            WindUI:Notify({
                Title = "üóëÔ∏è Successfully deleted the team.",
                Content = "‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
                Icon = "trash",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "‚ùå File not found",
                Content = "Unable to delete: File not found.",
                Icon = "folder-x",
                Duration = 3
            })
        end
    end
})
