local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HRP = LocalPlayer.Character:WaitForChild("HumanoidRootPart")
local HttpService = game:GetService("HttpService")

local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

WindUI:SetNotificationLower(true)

local Window = WindUI:CreateWindow({
    Title = "Tad Hub | Universe | 0.0.2",
    Icon = "door-open",
    Author = "By Tad Hub",
    Folder = "TadHub",
    Size = UDim2.fromOffset(550, 350),
    Transparent = true,
    Theme = "Dark",
    Resizable = true,
    SideBarWidth = 200,
    Background = "", -- rbxassetid only
    BackgroundImageTransparency = 0.42,
    HideSearchBar = true,
    ScrollBarEnabled = false,
    User = {
        Enabled = true,
        Anonymous = true,
        Callback = function()
            print("clicked")
        end,
    },
})

Window:EditOpenButton({
    Title = "Open Example UI",
    Icon = "monitor",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 2,
    Color = ColorSequence.new( -- gradient
        Color3.fromHex("FF0F7B"), 
        Color3.fromHex("F89B29")
    ),
    OnlyMobile = false,
    Enabled = true,
    Draggable = true,
})

Window:IsResizable(true)

Window:SetToggleKey(Enum.KeyCode.H)

local Tab = Window:Tab({
    Title = "Main",
    Icon = "bird",
    Locked = false,
})
local Section = Tab:Section({ 
    Title = "Setup Waypoints",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})

-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
local Waypoints = {}
local SelectedWaypointTeleport = nil
local SelectedWaypointDelete = nil
local WaypointName = ""

-- üìå ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Dropdown ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô Refresh
local DropdownTeleport = nil
local DropdownDelete = nil

local SelectedWaypointDelete = nil

-- üîÑ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Dropdown ‡∏ó‡∏±‡πâ‡∏á 2
local function UpdateDropdowns()
    local names = {}
    for _, wp in pairs(Waypoints) do
        if typeof(wp) == "table" and typeof(wp.Name) == "string" then
            table.insert(names, wp.Name)
        end
    end
    if DropdownTeleport then
        DropdownTeleport:Refresh(names)
    end
    if DropdownDelete then
        DropdownDelete:Refresh(names)
    end
end

-- üìù ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠
Tab:Input({
    Title = "üìù ‡∏ä‡∏∑‡πà‡∏≠ Waypoint",
    Desc = "‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£",
    Placeholder = "‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏î",
    Callback = function(text)
        WaypointName = text
    end
})

Tab:Button({
    Title = "‚ûï Set Waypoint",
    Desc = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì",
    Callback = function()
        if WaypointName == "" then
            WindUI:Notify({
                Title = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠",
                Content = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å",
                Icon = "type",
                Duration = 4,
            })
            return
        end

        table.insert(Waypoints, {Name = WaypointName, Pos = LocalPlayer.Character:FindFirstChild("HumanoidRootPart").Position})
        WaypointName = ""
        UpdateDropdowns()

        WindUI:Notify({
            Title = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
            Content = "‡πÄ‡∏û‡∏¥‡πà‡∏° Waypoint ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß",
            Icon = "check-circle",
            Duration = 3,
        })
    end
})

Tab:Button({
    Title = "üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Waypoints ‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå",
    Desc = "‡∏Å‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ã‡∏ü‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏•‡∏á‡πÑ‡∏ü‡∏•‡πå JSON ‡πÅ‡∏•‡∏∞ ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏•‡∏ö Waypoints ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢",
    Callback = function()
        if #Waypoints == 0 then
            WindUI:Notify({
                Title = "‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
                Content = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Waypoints ‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å",
                Icon = "alert-circle",
                Duration = 3,
            })
            return
        end

        -- ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
        if not isfolder("Waypoints") then
            makefolder("Waypoints")
        end

        local placeFolder = "Waypoints/" .. tostring(game.PlaceId)
        if not isfolder(placeFolder) then
            makefolder(placeFolder)
        end

        local filePath = placeFolder .. "/data.json"

        -- ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• JSON
        local data = {}
        for _, wp in pairs(Waypoints) do
            table.insert(data, {
                Name = wp.Name,
                Pos = {x = wp.Pos.X, y = wp.Pos.Y, z = wp.Pos.Z}
            })
        end

        local success, result = pcall(function()
            writefile(filePath, game:GetService("HttpService"):JSONEncode(data))
        end)

        if success then
            WindUI:Notify({
                Title = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                Content = "Waypoints ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà:\n" .. filePath,
                Icon = "save",
                Duration = 4,
            })
        else
            WindUI:Notify({
                Title = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                Content = "Error: " .. tostring(result),
                Icon = "x",
                Duration = 4,
            })
        end
    end
})

local Section = Tab:Section({ 
    Title = "Waypoints",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})

-- üìç Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏≤‡∏£‡πå‡∏õ
DropdownTeleport = Tab:Dropdown({
    Title = "üöÄ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ß‡∏≤‡∏£‡πå‡∏õ",
    Values = {},
    Value = nil,
    Callback = function(option)
        SelectedWaypointTeleport = option
    end
})

Tab:Button({
    Title = "üì¶ ‡∏ß‡∏≤‡∏£‡πå‡∏õ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Waypoint",
    Desc = "‡∏ß‡∏≤‡∏£‡πå‡∏õ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å",
    Callback = function()
        local character = LocalPlayer.Character
        if not character then
            WindUI:Notify({
                Title = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î",
                Content = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ (Character)",
                Icon = "alert-triangle",
                Duration = 4,
            })
            return
        end

        local HRP = character:FindFirstChild("HumanoidRootPart")
        if not HRP then
            WindUI:Notify({
                Title = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î",
                Content = "‡πÑ‡∏°‡πà‡∏û‡∏ö HumanoidRootPart",
                Icon = "alert-triangle",
                Duration = 4,
            })
            return
        end

        for _, wp in pairs(Waypoints) do
            if wp.Name == SelectedWaypointTeleport then
                HRP.CFrame = CFrame.new(wp.Pos)
                WindUI:Notify({
                    Title = "‡∏ß‡∏≤‡∏£‡πå‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                    Content = "‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡∏ß‡∏≤‡∏£‡πå‡∏õ‡πÑ‡∏õ‡∏¢‡∏±‡∏á: " .. wp.Name,
                    Icon = "map-pin",
                    Duration = 4,
                })
                return
            end
        end

        WindUI:Notify({
            Title = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",
            Content = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Waypoint ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡∏≤‡∏£‡πå‡∏õ",
            Icon = "target",
            Duration = 4,
        })
    end
})

local Section = Tab:Section({ 
    Title = "Remove Waypoints",
    TextXAlignment = "Left",
    TextSize = 17, -- Default Size
})

-- üóëÔ∏è Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö (‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏ß‡∏≤‡∏£‡πå‡∏õ)
DropdownDelete = Tab:Dropdown({
    Title = "üóëÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Waypoint ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö",
    Values = {},
    Value = nil,
    Callback = function(option)
        SelectedWaypointDelete = option
    end
})

Tab:Button({
    Title = "‚ùå ‡∏•‡∏ö Waypoint ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å",
    Desc = "‡∏•‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏ö",
    Callback = function()
        for i, wp in pairs(Waypoints) do
            if wp.Name == SelectedWaypointDelete then
                table.remove(Waypoints, i)
                SelectedWaypointDelete = nil
                SelectedWaypointTeleport = nil
                UpdateDropdowns()

                WindUI:Notify({
                    Title = "‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                    Content = "‡∏•‡∏ö Waypoint ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
                    Icon = "trash",
                    Duration = 3,
                })
                return
            end
        end

        WindUI:Notify({
            Title = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",
            Content = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Waypoint ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö",
            Icon = "target",
            Duration = 4,
        })
    end
})

-- üîÅ ‡πÇ‡∏´‡∏•‡∏î Waypoints ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏¢‡∏Å
do
    local placeFolder = "Waypoints/" .. tostring(game.PlaceId)
    local filePath = placeFolder .. "/data.json"

    if isfile(filePath) then
        local content = readfile(filePath)
        local success, data = pcall(function()
            return game:GetService("HttpService"):JSONDecode(content)
        end)

        if success and typeof(data) == "table" then
            table.clear(Waypoints)

            for _, wp in pairs(data) do
                if wp.Name and wp.Pos then
                    table.insert(Waypoints, {
                        Name = wp.Name,
                        Pos = Vector3.new(wp.Pos.x, wp.Pos.y, wp.Pos.z)
                    })
                end
            end

            UpdateDropdowns()

            WindUI:Notify({
                Title = "üì• ‡πÇ‡∏´‡∏•‡∏î Waypoints ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                Content = "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: " .. tostring(#Waypoints),
                Icon = "download",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß",
                Content = "‡∏≠‡πà‡∏≤‡∏ô JSON ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
                Icon = "x",
                Duration = 4
            })
        end
    else
        WindUI:Notify({
            Title = "‡πÇ‡∏õ‡∏£‡∏î‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Waypoints",
            Content = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏ô‡πÅ‡∏°‡∏û‡∏ô‡∏µ‡πâ",
            Icon = "folder",
            Duration = 3
        })
    end
end
